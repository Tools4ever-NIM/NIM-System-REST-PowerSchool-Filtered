{
    "schema": {
        "options": {},
        "crud_objects": {
            "students":{
                "operations":{
                    "students_get":{
                        "method":"get",
                        "call": {
                            "path": "/ws/v1/district/student"
                        },
                        "processing_options": {
                            "output_field": "students.student"
                        },
                        "query_parameters": {
				"q": "{student_filter}",
                                "extensions": "{student_extensions}",
                                "expansions": "{student_expansions}"
                        }
                    },
                    "student_update": {
                        "method": "post",
                        "call": {
                            "mode": "normal",
                            "path": "/ws/v1/student"
                        },
                        "body":{
                            "students":{
                                "student":{
                                    "client_uid":"NIM",
				    "id":"{id}",
                                    "action":"UPDATE",
				    "_nim_merge_attributes_": true
                                }
                            }
                        },
                        "semantics": "update"
                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "local_id": "string*",
                    "student_username": "string*",
                    "state_province_id": "number*",
                    "addresses":{
                        "mailing":{
                            "city":"_:string",
                            "street":"_:string",
                            "state_province":"_:string",
                            "postal_code":"_:string",
                            "grid_location":"_:string"
                        },
                        "physical":{
                            "city":"_:string",
                            "grid_location":"_:string",
                            "postal_code":"_:number",
                            "street":"_:string",
                            "state_province":"_:string"
                        }
                    },
                    "alerts":{
                        "discipline":{
                            "description":"_:string",
                            "expires_date":"_:string"
                        },
                        "legal":{
                            "description":"_:string",
                            "expires_date":"_:string"
                        },
                        "medical":{
                            "description":"_:string",
                            "expires_date":"_:string"
                        }
                    },
                    "contact":{
                        "doctor_name":"_:string",
                        "emergency_contact_name1":"_:string",
                        "emergency_contact_name2":"_:string",
                        "emergency_phone1":"_:string",
                        "emergency_phone2":"_:string",
                        "father":"_:string",
                        "guardian_email":"_:string",
                        "mother":"_:string"
                    },
                    "contact_info":{
                        "email":"_:string"
                    },
                    "demographics":{
                        "birth_date":"_:date*",
                        "gender":"_:string*",
                        "projected_graduation_year":"_:number*"
                    },
                    "ethnicity_race":{
                       "scheduling_reporting_ethnicity":"_:string"
                    },
                    "fees":{
                        "fee":[{
                            "category_name":"_:string",
                            "date_created":"_:string",
                            "fee_amount":"_:string",
                            "fee_balance":"_:string",
                            "fee_description":"_:string",
                            "fee_paid":"_:string",
                            "fee_transaction": {
                                "date":"_:string",
                                "description":"_:string",
                                "global_net_balance":"_:string",
                                "group_transaction_id":"_:number",
                                "id":"_:number",
                                "payment_method":"_:string",
                                "school_id":"_:number",
                                "start_year":"_:number",
                                "starting_balance":"_:string",
                                "student_id":"_:number",
                                "transaction_amount":"_:string",
                                "transaction_type":"_:string"
                            },
                            "group_transaction_id":"_:string",
                            "id":"_:string",
                            "priority":"_:string",
                            "pro_ratable_indicator":"_:string",
                            "school_id":"_:number",
                            "start_year":"_:number",
                            "student_id":"_:number",
                            "term_id":"_:number",
                            "transaction_date":"_:string",
                            "type_id":"_:number",
                            "type_name":"_:string"
                        }],
                        "fee_balance": [{
                            "balance":"_:string",
                            "credit":"_:string",
                            "debit":"_:string",
                            "fee_exemption_status":"_:string",
                            "fee_exemption_status_code":"_:number",
                            "id":"_:number",
                            "school_id":"_:number",
                            "student_id":"_:number",
                            "year_id":"_:number"
                        }]
                    },
                    "initial_enrollment":{
                        "district_entry_grade_level":"_:number",
                        "school_entry_grade_level":"_:number"
                    },
                    "lunch":{
                        "balance_1":"_:string",
                        "balance_2":"_:string",
                        "balance_3":"_:string",
                        "balance_4":"_:string",
                        "last_meal":"_:string",
                        "lunch_id":"_:number"
                    },
                    "name": {
                        "first_name": "string*",
                        "last_name": "string*",
						"middle_name": "string*"
                    },
                    "phones":{
                        "main":{
                            "number":"_:string*"
                        }
                    },
                    "schedule_setup":{
                        "home_room":"_:string",
                        "next_school":"_:number",
                        "sched_next_year_grade":"_:number"
                    },
                    "school_enrollment":{
                        "enroll_status":"_:string*",
                        "enroll_status_code":"_:number*",
                        "enroll_status_description":"_:string*",
                        "entry_code":"_:string",
                        "entry_comment":"_:string",
                        "entry_date":"_:date*",
                        "exit_code":"_:string",
                        "exit_comment":"_:string",
                        "exit_date":"_:date*",
                        "full_time_equivalency":{
                            "fteid":"_:number",
                            "name":"_:string"
                        },
                        "grade_level":"_:number*",
                        "school_id":"_:number*",
                        "school_number":"_:number",
                        "track": "_:string"
                    },
                    "_extension_data": "powerschool_extension_table*"
                }
            },
            "schools":{
                "operations":{
                    "schools_get":{
                        "method":"get",
                        "call": {
                            "mode":"normal",
                            "path": "/ws/v1/district/school",
                            "post_processing": "child_tables"
                        },
                        "processing_options": {
                            "output_field": "schools.school"
                        },
                        "query_parameters": {
                        }
                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "name": "string*",
                    "school_number": "string*",
                    "state_province_id": "string*",
                    "low_grade": "string",
                    "high_grade": "string",
                    "alternate_school_number": "string*",
                    "addresses":{
                        "physical":{
                            "city":"_:string",
                            "postal_code":"_:number",
                            "street":"_:string",
                            "state_province":"_:string"
                        }
                    },
                    "assistant_principal": {
                        "name":{
                            "first_name": "string",
                            "middle_name": "string",
                            "last_name": "string"
                        },
                        "email": "string"
                    },
                    "full_time_equivalencies": {
                        "full_time_equivalency": {
                            "fteid": "_:number",
                            "name": "_:string",
                            "start_year": "_:number",
                            "grade_level": "_:string"
                        }
                    },
                    "principal": {
                        "name":{
                            "first_name": "_:string",
                            "middle_name": "_:string",
                            "last_name": "_:string"
                        },
                        "email": "string"
                    },
                    "school_boundary": {
                        "points": {
                            "point": "string"
                        }
                    },
                    "school_fees_setup": {
                        "exemption_status": "number",
                        "fee_types": {
                            "fee_type": "_:number",
                            "name": "_:string",
                            "description": "_:string",
                            "category": "_:string",
                            "priority_order": "_:number",
                            "creation_date": "_:string"
                        },
                        "school_fees": {
                            "school_fee": {
                                "id": "_:number",
                                "amount": "_:string",
                                "description": "_:string",
                                "department": "_:string",
                                "department_id": "_:number",
                                "proratable": "_:number",
                                "start_year": "_:number",
                                "creation_date": "_:string",
                                "modified_date": "_:string",
                                "applicable_date": "_:string"
                            },
                            "fte_type": {
                                "id": "_:number",
                                "name": "_:string",
                                "description": "_:string",
                                "category": "_:string",
                                "priority_order": "_:number"
                            }
                        }
                    }
                    

                }
            },
            "staff":{
                "operations":{
                    "staffs_get":{
                        "method": "get",
                        "call": {
                            "mode": "iteration",
                            "table": "schools",
                            "iterator": "id",
                            "path": "/ws/v1/school/{iterator}/staff",
                            "base": {
                                "school_id": "{iterator}"
                            }
                        },
                        "processing_options": {
                            "output_field": "staffs.staff"
                        },
                        "query_parameters": {
                            "expansions": "{staff_expansions}",
                            "extensions": "{staff_extensions}"
                        },
                        "maxSessionCount": 20
                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "local_id": "string*",
                    "users_dcid": "string*",
                    "admin_username": "string",
                    "teacher_username": "string",
                    "teacher_global_id": "string*",
                    "staff_global_id": "string*",
                    "emails": {
                        "work_email": "_:string*",
                        "home_email": "_:string*"
                    },
                    "addresses":{
                        "home":{
                            "city":"_:string",
                            "street":"_:string",
                            "state_province":"_:string",
                            "postal_code":"_:number"
                        }
                    },
                    "name": {
                        "first_name": "_:string*",
                        "last_name": "_:string*",
                        "middle_name": "_:string*"
                    },
                    "phones":{
                        "home_phone":"_:string"
                    },
                    "school_affiliations": {
                        "school_affiliation": {
                            "school_id": "_:number*",
                            "type": "_:number*",
                            "status": "_:number*"
                        }
                    },
                    "_extension_data": "powerschool_extension_table*"
                }
            },
            "enrollments":{
                "operations":{
                    "enrollments_get":{
                        "method": "get",
                        "call": {
                            "mode": "iteration",
                            "table": "sections",
                            "iterator": "id",
                            "path": "/ws/v1/section/{iterator}/section_enrollment",
                            "base": {
                                "section_id": "{iterator}"
                            },
                            "post_processing": "child_tables"
                        },
                        "processing_options": {
                            "output_field": "section_enrollments.section_enrollment"
                        },                        
                        "maxPageCount": -1,
                        "maxSessionCount": 10,
                        "query_parameters": {}

                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "section_id": "number*",
                    "student_id": "number*",
                    "entry_date": "date*",
                    "exit_date": "date*",
                    "dropped": "boolean*"
                }
            },
            "sections":{
                "operations":{
                    "sections_get":{
                        "method": "get",
                        "call": {
                            "mode": "iteration",
                            "table": "schools",
                            "iterator": "id",
                            "path": "/ws/v1/school/{iterator}/section",
                            "post_processing": "child_tables",
                            "base": {
                                "school_id": "{iterator}"
                            }
                        },
                        "processing_options": {
                            "output_field": "sections.section"
                        },
                        "query_parameters": {
                            "q": "{section_filter}"
                        },
                        "maxSessionCount": 20

                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "school_id": "number*",
                    "course_id": "number*",
                    "term_id": "number*",
                    "section_number": "string*",
                    "expression": "string*",
                    "staff_id": "string*"
                }
            },
            "courses":{
                "operations":{
                    "courses_get":{
                        "method": "get",
                        "call": {
                            "mode": "iteration",
                            "table": "schools",
                            "iterator": "id",
                            "path": "/ws/v1/school/{iterator}/course",
                            "base": {
                                "school_id": "{iterator}"
                            }
                        },
                        "processing_options": {
                            "output_field": "courses.course"
                        },
                        "maxSessionCount": 20

                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "course_number": "string*",
                    "course_name": "string*"
                }
            },
            "terms":{
                "operations":{
                    "terms_get":{
                        "method": "get",
                        "call": {
                            "mode": "iteration",
                            "table": "schools",
                            "iterator": "id",
                            "path": "/ws/v1/school/{iterator}/term",
                            "base": {
                                "school_id": "{iterator}"
                            }
                        },
                        "processing_options": {
                            "output_field": "terms.term"
                        },
                        "query_parameters": {
                            "q": "{term_filter}"
                        },
                        "maxSessionCount": 20

                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "school_id": "number*",
                    "start_year": "number*",
                    "portion": "number*",
                    "start_date": "date*",
                    "end_date": "date*",
                    "abbreviation": "string",
                    "name": "string*"
                }
            },
            "contacts":{
                "operations":{
                    "contacts_get":{
                        "method": "get",
                        "verb": "post",
                        "call": {
                            "mode": "normal",
                            "path": "/ws/schema/query/com.tools4ever.students.contacts.listall"
                        },
                        "body":{ },
                        "processing_options": {
                            "output_field": "record"
                        },
                        "query_parameters": {
                        }
                    }
                },
                "parameters":{},
                "key":"id",
                "resources":{
                    "id": "number*",
                    "name": "string",
                    "tables": {
                        "students": {
                            "contact_firstname": "_:string*",
                            "contact_isactive": "_:boolean*",
                            "contact_lastname": "_:string*",
							"contactpriorityorder": "_:string*",
                            "dcid": "_:number*",
                            "emailaddress": "_:string*",
                            "iscustodial": "_:boolean*",
                            "isemergency": "_:boolean*",
                            "livewith": "_:boolean*",
                            "person_isactive": "_:boolean*",
                            "receivesmail": "_:boolean*",
                            "relationship": "_:string*",
                            "schoolpickup": "_:boolean",
                            "student_firstname": "_:string",
                            "student_lastname": "_:string",
                            "student_number": "_:number"					   
                        }
                    }
                }
            }
        }
		
	},
    "rest": {
        "config": {
            "baseUrl": "https://{tenant_id}",
            "get": {
                "maxPageCount": 5,
                "query_parameters": {

                },
                "pagination":{
                    "mode":"generic",
                    "path":[],
                    "params":{
                        "page":"{page_number}",
                        "pagesize":"{page_size}"
                    }
                }
            },
            "authentication": "client_credentials",
            "call_handling": "generic",
            "test_connection": {
                "url": "/ws/v1/district/student/count"
            },
			"retry": [
                {
                    "type": "statusCode",
                    "statusCode": 504,
                    "retry": {
                        "type": "simple",
                        "maxCount": 10,
                        "waitTime": 5
                    }
                },
                {
                    "type": "connectionError"
                }
            ]
        },
        "authOptions": {
            "authUrl": "https://{tenant_id}/oauth/access_token",
            "directToken":true
        }
    },
    "connection":{
        "items": [
            {
                "name": "page_size",
                "type": "textbox",
                "label": "Page Size:",
                "value": "100"
            },
            {
                "name": "student_filter",
                "type": "textbox",
                "label": "Student Filter:",
                "value": "name.last_name==*;school_enrollment.enroll_status_code==(0)"
            },
            {
                "name": "student_expansions",
                "type": "textbox",
                "label": "Student Expansions",
                "value": "addresses,alerts,contact,contact_info,demographics,ethnicity_race,initial_enrollment,lunch,name,phones,schedule_setup,school_enrollment"
            },
            {
                "name": "student_extensions",
                "type": "textbox",
                "label": "Student Extensions",
                "value": "u_students_extension,studentcorefields"
            },
            {
                "name": "section_filter",
                "type": "textbox",
                "label": "Section Filter:",
                "value": "term.start_year==2022"
            },
            {
                "name": "term_filter",
                "type": "textbox",
                "label": "Term Filter:",
                "value": "start_year==2022"
            },
            {
                "name": "staff_expansions",
                "type": "textbox",
                "label": "Staff Expansions",
                "value": "addresses,emails,phones,school_affiliations,school_counselors,teacher_global_id,staff_global_id"
            },
            {
                "name": "staff_extensions",
                "type": "textbox",
                "label": "Staff Extensions",
                "value": "s_ssf_ncea_x"
            }
        ]
    }
}
